worker_processes 1;

events {
    worker_connections 1024;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;

    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';
    access_log /var/log/nginx/access.log main;
    error_log /var/log/nginx/error.log warn;

    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;

    server {
    	listen 80;
    	server_name test-lv.duckdns.org;

    	# Main root directory
    	root /usr/share/nginx/html; # Base directory

    	# Serve static files
    	location /webmofsynth/static/ {
        	alias /usr/share/nginx/html/static/;
    	}

    	# Serve templates
    	location /webmofsynth/templates/ {
        	alias /usr/share/nginx/html/templates/;
    	}

    	# Default handling for HTML files
    	location /webmofsynth/ {
        	try_files $uri $uri/ /webmofsynth/templates/index.html;
    	}

    	# Custom error pages
    	error_page 404 /webmofsynth/templates/404.html;
    	location = /webmofsynth/templates/404.html {
        	internal;
    	}

    	error_page 500 502 503 504 /webmofsynth/templates/50x.html;
    	location = /webmofsynth/templates/50x.html {
        	internal;
    	}
    }
}
